# Excel宏入门：自动化你的日常工作

Excel宏可不是啥高深莫测的东西，它就是帮你把那些天天重复到想撞墙的操作自动化。说白了，宏就是一连串Excel动作的录制，录好后点一下就能自动执行，比你手动点来点去快多了。

## 啥是宏？为啥要用它？

宏其实就是VBA（Visual Basic for Applications）代码的集合，它能模拟你在Excel里的各种操作。你想想，每天都要打开同一个报表，整理数据，做同样的计算，搞同样的格式，换谁都烦。宏就是来解救你的。
    
    
    '这是一个简单的宏示例
    Sub 你好世界()
        MsgBox “嘿，这是我的第一个宏！”
    End Sub
    

这段代码执行后，就会弹出一个对话框，显示那句话。挺简单吧？不过宏的威力可远不止于此。

## 咋开启Excel的开发工具选项卡

用宏的第一步是得找到它在哪儿。微软把它藏得有点深，得先把“开发工具”选项卡弄出来。

  1. 点击“文件” → “选项”
  2. 在Excel选项窗口里，点“自定义功能区”
  3. 右侧的复选框里，把“开发工具”前面的勾打上
  4. 点“确定”

搞定！现在你的功能区上方就多了个“开发工具”选项卡，里面有“Visual Basic”、“宏”等按钮。

温馨提示：如果你用的是Excel 2007，操作路径有点不一样，是点Office按钮→Excel选项→常用→勾选“在功能区显示'开发工具'选项卡”。

## 录制你的第一个宏

录制宏跟录视频差不多，开始录制后你的所有操作都会被记录下来。

  1. 点“开发工具” → “录制宏”
  2. 给你的宏起个名（不能有空格和特殊字符）
  3. 快捷键可填可不填，建议填一个方便你用
  4. “存储位置”选“个人工作簿”（只给当前文件用）或“个人宏工作簿”（所有Excel都能用）
  5. “描述”里随便写点啥，方便以后知道这宏是干嘛的
  6. 点“确定”，开始录制

录制过程中，你做的每一步操作Excel都会偷偷记下来。比如你选了单元格A1，输入了“销售额”，加了粗体，Excel都记着呢。

录完了，点“开发工具” → “停止录制”。这样，你的第一个宏就诞生了！

## 运行宏

录好的宏，你可以这样用：

  1. 点“开发工具” → “宏”
  2. 选择你要运行的宏名称
  3. 点“运行”

或者用你设置的快捷键一键执行，比如Alt+Shift+A。快捷键超好用，强烈推荐设置。
    
    
    '格式化销售报表的宏示例
    Sub 格式化销售报表()
        '选择区域并加粗
        Range(“A1：D1”).Select
        Selection.Font.Bold = True
        
        '设置标题
        Range(“A1”).Value = “日期”
        Range(“B1”).Value = “产品”
        Range(“C1”).Value = “数量”
        Range(“D1”).Value = “金额”
        
        '自动调整列宽
        Columns(“A：D”).AutoFit
    End Sub
    

这个宏跑完，就给你做好了一个有标题的表格，省去了手动输入和格式化的麻烦。

## 宏的安全性问题

听说过宏病毒没？那是因为宏可以执行代码，坏人可以用它搞破坏。所以Excel默认是禁用宏的。

要用宏，得先调整安全设置：

  1. 点“开发工具” → “宏安全性”
  2. 有四个选项，建议选“禁用所有宏，但发出通知”

这样，当你打开带宏的文件时，Excel会在顶部显示安全警告，你可以选择启用宏。自己做的宏当然可以放心启用啦。

温馨提示：别随便启用陌生文件的宏，尤其是从网上下载或邮件收到的，小心有病毒。

## 修改已有的宏

录好的宏，还能修改呢。万一录制时手滑点错了，不用重录，直接改代码就行。

  1. 点“开发工具” → “Visual Basic”（或按Alt+F11）
  2. 在左侧找到你的工作簿和模块
  3. 双击打开模块，找到你的宏代码
  4. 修改代码，改完按Ctrl+S保存

    
    
    '给上面的宏加点料
    Sub 格式化销售报表增强版()
        '选择区域并加粗
        Range(“A1：D1”).Select
        Selection.Font.Bold = True
        
        '设置标题
        Range(“A1”).Value = “日期”
        Range(“B1”).Value = “产品”
        Range(“C1”).Value = “数量”
        Range(“D1”).Value = “金额”
        
        '自动调整列宽
        Columns(“A：D”).AutoFit
        
        '给标题行加背景色
        Range(“A1：D1”).Interior.Color = RGB(200， 200， 200)
        
        '加个合计行
        Range(“A5”).Value = “合计”
        Range(“D5”).Formula = “=SUM(D2：D4)”
        Range(“D5”).Font.Bold = True
    End Sub
    

看，我给原来的宏加了背景色和合计功能，一下高大上了不少。

## 实用宏案例：批量格式化

来个实用点的例子，假设你每天要处理一堆数据，格式还得统一。
    
    
    Sub 批量格式化数据()
        '清除所有格式
        Cells.ClearFormats
        
        '给首行加粗
        Range(“A1：F1”).Font.Bold = True
        
        '数值格式化为两位小数
        Range(“D：D，F：F”).NumberFormat = “0.00”
        
        '日期列格式化
        Range(“A：A”).NumberFormat = “yyyy-mm-dd”
        
        '偶数行加底色
        Dim i As Integer
        For i = 2 To 100 Step 2
            Range(“A” & i & “：F” & i).Interior.Color = RGB(240， 240， 240)
        Next i
        
        '自动调整所有列宽
        Columns(“A：F”).AutoFit
        
        MsgBox “格式化完成！”
    End Sub
    

这个宏一键帮你：清除原有格式、给标题加粗、数字保留两位小数、日期格式化、偶数行加底色、自动调列宽。要手动做这些，得点多少下鼠标？

## 宏的保存和分享

录好的宏不保存就白忙活了。Excel文件得以`.xlsm`格式保存，这是支持宏的格式。`.xlsx`是不支持宏的，存了等于白存。

  1. 点“文件” → “另存为”
  2. “保存类型”选“Excel启用宏的工作簿(*.xlsm)”
  3. 取个名，点保存

想跟同事分享你的宏？直接把这个xlsm文件发给他就行。不过先提醒他调整安全设置，不然你的宏可能被Excel自动禁用。

宏是Excel里的神器，学会用它，你的工作效率能飙升，尤其是处理重复性工作的时候。刚开始可能觉得录制宏麻烦，但想想以后省下的时间，这点学习成本真是太值了。写几个高效的宏，从此跟加班说拜拜！‌​​‌​​‌​‌​​‌‌‌‌​‌​​‌​​​​‌​​‌‌​​​‌​​‌‌​‌​‌‌​​‌‌‌​‌‌​​‌​​​‌‌​​​‌‌‌‌‌​​​‌‌‌‌‌​​​‌‌‌